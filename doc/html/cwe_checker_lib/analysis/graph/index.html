<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Generate control flow graphs out of a program term."><title>cwe_checker_lib::analysis::graph - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-9ee3a5e31a2afa3e.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="cwe_checker_lib" data-themes="" data-resource-suffix="" data-rustdoc-version="1.75.0 (82e1608df 2023-12-21)" data-channel="1.75.0" data-search-js="search-8fbf244ebcf71464.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../../../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-9dd44ab47b99a0fb.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../cwe_checker_lib/index.html">cwe_checker_lib</a><span class="version">0.8.0</span></h2></div><h2 class="location"><a href="#">Module graph</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Aliases</a></li></ul></section><h2><a href="../index.html">In cwe_checker_lib::analysis</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">analysis</a>::<wbr><a class="mod" href="#">graph</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../../src/cwe_checker_lib/analysis/graph.rs.html#1-666">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Generate control flow graphs out of a program term.</p>
<p>The generated graphs follow some basic principles:</p>
<ul>
<li><strong>Nodes</strong> denote specific (abstract) points in time during program execution,
i.e. information does not change on a node.
So a basic block itself is not a node,
but the points in time before and after execution of the basic block can be nodes.</li>
<li><strong>Edges</strong> denote either transitions between the points in time of their start and end nodes during program execution
or they denote (artificial) information flow between nodes. See the <code>CRCallStub</code> edges of interprocedural control flow graphs
for an example of an edge that is only meant for information flow and not actual control flow.</li>
</ul>
<h2 id="general-assumptions"><a href="#general-assumptions">General assumptions</a></h2>
<p>The graph construction algorithm assumes
that each basic block of the program term ends with zero, one or two jump instructions.
In the case of two jump instructions the first one is a conditional jump
and the second one is an unconditional jump.
Conditional calls are not supported.
Missing jump instructions are supported to indicate incomplete information about the control flow,
i.e. points where the control flow reconstruction failed.
These points are converted to dead ends in the control flow graphs.</p>
<h2 id="interprocedural-control-flow-graph"><a href="#interprocedural-control-flow-graph">Interprocedural control flow graph</a></h2>
<p>The function <a href="fn.get_program_cfg.html"><code>get_program_cfg</code></a> builds an interprocedural control flow graph out of a program term as follows:</p>
<ul>
<li>Each basic block (<a href="../../../../../doc/images/node_edge.png"><code>image</code></a>) is converted into two nodes, <em>BlkStart</em> and <em>BlkEnd</em>,
and a <em>block</em> edge from <em>BlkStart</em> to <em>BlkEnd</em>.</li>
<li>Jumps and calls inside the program are converted to <em>Jump</em> or <em>Call</em> edges from the <em>BlkEnd</em> node of their source
to the <em>BlkStart</em> node of their target (which is the first block of the target function in case of calls).</li>
<li>Calls to library functions (<a href="../../../../../doc/images/extern_calls.png"><code>image</code></a>) outside the program are converted to <em>ExternCallStub</em> edges
from the <em>BlkEnd</em> node of the callsite to the <em>BlkStart</em> node of the basic block the call returns to
(if the call returns at all).</li>
<li>Right now indirect calls are handled as if they were extern calls, i.e. an <em>ExternCallStub</em> edge is added.
This behaviour will change in the future, when better indirect call handling is implemented.</li>
<li>For each in-program call (<a href="../../../../../doc/images/internal_function_call.png"><code>image</code></a>) and corresponding return jump two nodes and four edges are generated:
<ul>
<li>An artificial node <em>CallReturn</em> and node <em>CallSource</em></li>
<li>A <em>CRCallStub</em> edge from the <em>BlkEnd</em> node of the callsite to <em>CallReturn</em></li>
<li>A <em>CRReturnStub</em> edge from the <em>BlkEnd</em> node of the returning from block to <em>CallReturn</em></li>
<li>A <em>ReturnCombine</em> edge from <em>CallReturn</em> to the <em>BlkStart</em> node of the returned to block.</li>
<li>A <em>CallCombine</em> edge from the <em>BlkEnd</em> node to the <em>CallSource</em> node.</li>
</ul>
</li>
</ul>
<p>The artificial <em>CallReturn</em> nodes enable enriching the information flowing through a return edge
with information recovered from the corresponding callsite during a fixpoint computation.</p>
</div></details><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Edge.html" title="enum cwe_checker_lib::analysis::graph::Edge">Edge</a></div><div class="desc docblock-short">The edge type of an interprocedural fixpoint graph.</div></li><li><div class="item-name"><a class="enum" href="enum.Node.html" title="enum cwe_checker_lib::analysis::graph::Node">Node</a></div><div class="desc docblock-short">The node type of an interprocedural control flow graph</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.get_entry_nodes_of_subs.html" title="fn cwe_checker_lib::analysis::graph::get_entry_nodes_of_subs">get_entry_nodes_of_subs</a></div><div class="desc docblock-short">Returns a map from function TIDs to the node index of the <code>BlkStart</code> node of the first block in the function.</div></li><li><div class="item-name"><a class="fn" href="fn.get_program_cfg.html" title="fn cwe_checker_lib::analysis::graph::get_program_cfg">get_program_cfg</a></div><div class="desc docblock-short">Build the interprocedural control flow graph for a program term.</div></li><li><div class="item-name"><a class="fn" href="fn.get_program_cfg_with_logs.html" title="fn cwe_checker_lib::analysis::graph::get_program_cfg_with_logs">get_program_cfg_with_logs</a></div><div class="desc docblock-short">Build the interprocedural control flow graph for a program term with log messages created by building.</div></li></ul><h2 id="types" class="small-section-header"><a href="#types">Type Aliases</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.Graph.html" title="type cwe_checker_lib::analysis::graph::Graph">Graph</a></div><div class="desc docblock-short">The graph type of an interprocedural control flow graph</div></li></ul></section></div></main></body></html>