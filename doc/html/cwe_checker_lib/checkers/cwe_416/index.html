<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module implements a check for CWE-415: Double Free and CWE-416: Use After Free."><title>cwe_checker_lib::checkers::cwe_416 - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="cwe_checker_lib" data-themes="" data-resource-suffix="" data-rustdoc-version="1.70.0 (90c541806 2023-05-31)" data-search-js="search-e077946657036a58.js" data-settings-js="settings-298e1ea74db45b39.js" data-settings-css="settings-7bfb4c59cc6bc502.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../../../static.files/main-f61008743c98d196.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../cwe_checker_lib/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../cwe_checker_lib/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module cwe_416</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#statics">Statics</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">cwe_checker_lib</a>::<wbr><a href="../index.html">checkers</a>::<wbr><a class="mod" href="#">cwe_416</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/cwe_checker_lib/checkers/cwe_416/mod.rs.html#1-320">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module implements a check for CWE-415: Double Free and CWE-416: Use After Free.</p>
<p>If a program tries to reference memory objects or other resources after they have been freed
it can lead to crashes, unexpected behaviour or even arbitrary code execution.
The same is true if the program tries to free the same resource more than once
as this can lead to another unrelated resource being freed instead.</p>
<p>See <a href="https://cwe.mitre.org/data/definitions/415.html">https://cwe.mitre.org/data/definitions/415.html</a> and <a href="https://cwe.mitre.org/data/definitions/416.html">https://cwe.mitre.org/data/definitions/416.html</a> for detailed descriptions.</p>
<h3 id="how-the-check-works"><a href="#how-the-check-works">How the check works</a></h3>
<p>Using an interprocedural, bottom-up dataflow analysis
based on the results of the <a href="../../analysis/pointer_inference/index.html" title="mod cwe_checker_lib::analysis::pointer_inference">Pointer Inference analysis</a>
the check keeps track of memory objects that have already been freed.
If a pointer to an already freed object is used to access memory or provided as a parameter to another function
then a CWE warning is generated.
To prevent duplicate CWE warnings with the same root cause
the check also keeps track of objects for which a CWE warning was already generated.</p>
<h4 id="symbols-configurable-in-configjson"><a href="#symbols-configurable-in-configjson">Symbols configurable in config.json</a></h4>
<p>The <code>deallocation_symbols</code> are the names of extern functions that deallocate memory.
The check always assumes that the first parameter of such a function is the memory object to be freed.
The check also assumes that memory is always freed by such a call,
which can lead to false positive warnings for functions like <code>realloc</code>, where the memory object may not be freed by the call.</p>
<h3 id="false-positives"><a href="#false-positives">False Positives</a></h3>
<ul>
<li>Since the analysis is not path-sensitive, infeasible paths may lead to false positives.</li>
<li>Any analysis imprecision of the pointer inference analysis
that leads to assuming that a pointer can target more memory objects that it actually can target
may lead to false positive CWE warnings in this check.</li>
<li>For extern functions that may or may not release memory,
the check will produce false positives if the original pointer is used after calling the function.
For example, <code>realloc</code> may return NULL, in which case it will not free memory and the original pointer remains valid.
But the check will flag any access to the original pointer as a potential CWE, regardless of the return value of <code>realloc</code>.</li>
</ul>
<h3 id="false-negatives"><a href="#false-negatives">False Negatives</a></h3>
<ul>
<li>Arrays of memory objects are not tracked by this analysis as we currently cannot distinguish different array elements in the analysis.
Subsequently, CWEs corresponding to arrays of memory objects are not detected.</li>
<li>Memory objects not tracked by the Pointer Inference analysis or pointer targets missed by the Pointer Inference
may lead to missed CWEs in this check.</li>
<li>Pointers freed by other operations than calls to the deallocation symbols contained in the config.json will be missed by the analysis.</li>
</ul>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Config.html" title="struct cwe_checker_lib::checkers::cwe_416::Config">Config</a></div><div class="desc docblock-short">The configuration struct</div></li><li><div class="item-name"><a class="struct" href="struct.WarningContext.html" title="struct cwe_checker_lib::checkers::cwe_416::WarningContext">WarningContext</a></div><div class="desc docblock-short">A struct for collecting CWE warnings together with context information
that can be used to post-process the warning after the fixpoint has been computed.</div></li></ul><h2 id="statics" class="small-section-header"><a href="#statics">Statics</a></h2><ul class="item-table"><li><div class="item-name"><a class="static" href="static.CWE_MODULE.html" title="static cwe_checker_lib::checkers::cwe_416::CWE_MODULE">CWE_MODULE</a></div><div class="desc docblock-short">The module name and version</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.check_cwe.html" title="fn cwe_checker_lib::checkers::cwe_416::check_cwe">check_cwe</a></div><div class="desc docblock-short">Run the check for CWE-416: Use After Free.</div></li></ul></section></div></main></body></html>